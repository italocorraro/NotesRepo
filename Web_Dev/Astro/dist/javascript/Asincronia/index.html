<!DOCTYPE html><html lang="it" data-astro-cid-hpxbdaly> <head><title class="htmlCodeTitle">Asincronia in JavaScript</title><meta class="htmlCodeChar" charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Astro v5.15.9"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="icon" sizes="32x32" href="/NotesRepo/Web_Dev/Astro/dist/Crocco.png" type="image/x-icon"><!-- Generic tags --><meta class="htmlCodeAuthor" name="author" content="Italo Corraro"><meta class="htmlCodeDescription" name="description" content="Appunti e note sul concetto di asincronia e promesse in JavaScript."><!-- Open Graph tags --><meta property="og:title" content="Appunti sull'Asincronia in JavaScript"><meta property="og:description" content="Appunti e note sul concetto di asincronia e promesse in JavaScript."><meta property="og:type" content="website"><meta property="og:locale" content="it_IT"><meta property="og:image" content="https://italocorraro.github.io/NotesRepo/Web_Dev/source/Crunch.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="799"><meta property="og:image:height" content="400"><!-- Twitter Card tags --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Appunti sull'Asincronia in JavaScript"><meta name="twitter:description" content="Appunti e note sul concetto di asincronia e promesse in JavaScript."><meta name="twitter:image" content="https://italocorraro.github.io/NotesRepo/Web_Dev/source/Crunch.png"><meta class="htmlCodeAuthor" name="author" content="Italo Corraro"><link href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" rel="stylesheet"><link rel="stylesheet" href="/NotesRepo/Web_Dev/Astro/dist/_astro/DOM.D6sKYChe.css">
<style>nav[data-astro-cid-sf7rw5md]{display:flex;padding:0 1.5em;width:100%;max-width:100%;justify-content:center}nav[data-astro-cid-sf7rw5md]>[data-astro-cid-sf7rw5md]{width:33%;text-transform:uppercase}nav[data-astro-cid-sf7rw5md]>[data-astro-cid-sf7rw5md]:first-child{text-align:left}nav[data-astro-cid-sf7rw5md]>a[data-astro-cid-sf7rw5md]:first-child:before{content:"<"}nav[data-astro-cid-sf7rw5md]>[data-astro-cid-sf7rw5md]:last-child{text-align:right}nav[data-astro-cid-sf7rw5md]>a[data-astro-cid-sf7rw5md]:last-child:after{content:">"}nav[data-astro-cid-sf7rw5md]>a[data-astro-cid-sf7rw5md]:first-child:before,nav[data-astro-cid-sf7rw5md]>a[data-astro-cid-sf7rw5md]:last-child:after{display:inline-block;transform:translateY(-.05em)}p[data-astro-cid-gcm7ptol]{margin:0}footer[data-astro-cid-jyhwcbfj]{display:flex;gap:.8rem;margin-top:2rem;padding:1rem 0;flex-direction:column}p[data-astro-cid-jyhwcbfj]{margin:0}
</style></head> <body data-astro-cid-hpxbdaly> <header id="site-header" data-astro-cid-3ef6ksr2> <button type="button" aria-expanded="false" aria-controls="mainNav" aria-label="Menu"> 
Menu
</button> <nav id="mainNav" aria-label="Navigazione Sito"> <ul> <li class="nav-item"><span>HTML</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Sintassi html/">Sintassi html</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Struttura Semantica/">Struttura Semantica</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/L'elemento head/">L&#39;elemento &lt;head&gt;</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Ancore/">Ancore</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Liste/">Liste</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Immagini/">Immagini</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Altri Media/">Altri Media</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Tabelle">Tabelle</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/html/Forms/">Form</a></li> </ul> </li><li class="nav-item"><span>CSS</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Sintassi CSS/">Sintassi CSS</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Selectors/">Selettori</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Box Model/">Box Model</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Unità di Misura/">Unità di misura</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Colori/">Colori</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Immagini/">Immagini</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Funzioni e Variabili/">Funzioni e Variabili</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Background/">Background</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Tipografia/">Tipografia</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Altri Stili/#liste">Liste</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Altri Stili/#ancore">Ancore</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Tabelle/">Tabelle</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Form/">Form</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Media Queries/">Media Queries</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Layout con Float/">Layout con Float</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Layout con Flexbox/">Layout con Flexbox</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Layout con Grid/">Layout con Grid</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Altri Stili/">Altri Stili</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/CSS/Transizioni-Animazioni/">Animazioni &amp; Transizioni</a></li> </ul> </li><li class="nav-item"><span>JavaScript</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Overview/">Overview</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Tipi di Dato/">Tipi di Dato</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Operatori/">Operatori</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Numeri/">Numeri</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Stringhe/">Stringhe</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Array/">Array</a></li><li class="nav-link"> Espressioni Regolari</li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Date/">Date</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Controllo di Flusso/">Controllo di Flusso</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Iterazione/">Iterazione</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Funzioni/">Funzioni</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Strict Mode/">Strict Mode</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Oggetti/">Oggetti</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Collezioni Indicizzate/">Collezioni Indicizzate</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Ereditarietà/">Ereditarietà</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Classi/">Classi</a></li><li class="nav-link"> Garbage Collection</li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Asincronia/">Asincronia</a></li><li class="nav-link"> Moduli</li> </ul> </li><li class="nav-item"><span>JS APIs</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/APIs/DOM/">DOM API</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/APIs/Eventi/">UI Events API</a></li><li class="nav-link"> Storage API</li><li class="nav-link"> URL API</li><li class="nav-link"> View Transition API</li><li class="nav-link"> Intersection Observer API</li><li class="nav-link"> Pointer Events</li> </ul> </li><li class="nav-item"><span>Struttura Pagine</span> <ul> <li class="nav-link"> Struttura html</li><li class="nav-link"> Struttura CSS</li> </ul> </li><li class="nav-item"><span>TypeScript</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/typescript/Overview/">Overview</a></li> </ul> </li><li class="nav-item"><span>Markdown</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/Markdown/Sintassi Markdown/">Sintassi</a></li><li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/Markdown/GFM/">GitHub Flavored</a></li><li class="nav-link"> Remark Plugins</li> </ul> </li><li class="nav-item"><span>Svelte</span> <ul> <li class="nav-link"> <a href="/NotesRepo/Web_Dev/Astro/dist/Svelte/Overview/">Overview</a></li> </ul> </li><li class="nav-item"><span>Astro</span> <ul> <li class="nav-link"> Overview</li> </ul> </li> </ul> </nav> <div id="mainNavBackdrop"></div> <script type="module">const i=document.querySelector("button:has(+ #mainNav)");i?.addEventListener("click",()=>{const t=i.getAttribute("aria-expanded")==="true";i.setAttribute("aria-expanded",`${!t}`)});const o=document.querySelector("#mainNav + div");o?.addEventListener("click",()=>{i?.setAttribute("aria-expanded","false")});function a(t,e=400){t.style.transition=`height ${e}ms ease`,t.style.height=t.scrollHeight+"px",requestAnimationFrame(()=>{t.style.height="0"}),setTimeout(()=>{t.style.display="none"},e)}function n(t,e=400){t.style.display="block";let s=t.scrollHeight;t.style.height="0",t.style.transition=`height ${e}ms ease`,requestAnimationFrame(()=>{t.style.height=s+"px"}),setTimeout(()=>{t.style.height="auto"},e)}function l(t,e=400){window.getComputedStyle(t).display==="none"?n(t,e):a(t,e)}document.querySelectorAll(".nav-item").forEach(t=>{let e=t.querySelector("ul"),s=t.querySelector("span");a(e),s?.addEventListener("click",()=>{l(e,400)})});</script> <aside aria-labelledby="site-settings"> <h2 id="site-settings">Impostazioni Tema</h2> <!-- Impostazioni TEMA SHIKI --> <form id="shiki-theme-settings" class="astro-code"> <input type="radio" name="shiki-theme" id="shiki-light" value="light"> <label for="shiki-light" title="Tema Chiaro"> <span class="text-only">Tema Chiaro</span> <svg width="60" height="60" viewBox="0 0 100 100" aria-hidden="true"> <!-- Disco centrale --> <circle cx="50" cy="50" r="22" fill="var(--shiki-light)"></circle> <!-- Raggi --> <g stroke="var(--shiki-light)" stroke-width="8" stroke-linecap="round"> <line x1="50" y1="6" x2="50" y2="22"></line> <line x1="50" y1="78" x2="50" y2="94"></line> <line x1="6" y1="50" x2="22" y2="50"></line> <line x1="78" y1="50" x2="94" y2="50"></line> <line x1="21" y1="21" x2="32" y2="32"></line> <line x1="78" y1="78" x2="67" y2="67"></line> <line x1="21" y1="79" x2="32" y2="68"></line> <line x1="79" y1="21" x2="68" y2="32"></line> </g> </svg> </label> <input type="radio" name="shiki-theme" id="shiki-dark" value="dark"> <label for="shiki-dark" title="Tema Scuro"> <span class="text-only">Tema Scuro</span> <svg width="60" height="60" viewBox="0 0 100 100" aria-hidden="true"> <!-- Disco completo --> <circle cx="50" cy="50" r="40" fill="var(--shiki-dark-code)" opacity="0.25"></circle> <!-- Falce luminosa (più larga rispetto alla versione precedente) --> <path d="M45 10
           A40 40 0 1 0 45 90
           A28 40 0 1 1 45 10Z" fill="var(--shiki-dark)"></path> </svg> </label> <input type="radio" name="shiki-theme" id="shiki-dracula" value="dracula"> <label for="shiki-dracula" title="Tema Dracula"> <span class="text-only">Tema Dracula</span> <img src="https://user-images.githubusercontent.com/33915497/214760369-5c078b43-fdab-4cdd-adfe-ad905a64b5a5.png" decoding="sync" loading="eager" alt="logo tema Dracula da GitHub" fetchpriority="auto" width="60" height="60"> </label> <input type="radio" name="shiki-theme" id="shiki-system" value="" checked> <label for="shiki-system" title="Tema Predefinito"><span class="text-only">Tema Predefinito</span> <svg width="48" height="48" viewBox="0 0 24 24" aria-hidden="true"> <!-- Mezzo sole a sinistra --> <g fill="var(--font-color)"> <!-- Semicerchio del sole --> <path d="M12 4a8 8 0 0 0 0 16V4z"></path> </g> <!-- Mezzo cerchio scuro a destra --> <path fill="var(--font-color)" d="M12 4a8 8 0 1 1 0 16V4z" opacity="0.4"></path> </svg> </label> </form> </aside> <script type="module">const o="my-notes-repo-theme",s=sessionStorage.getItem(o),n=document.documentElement,r=document.querySelectorAll('#shiki-theme-settings > [type="radio"]');s&&typeof s=="string"&&n.setAttribute("data-theme",s);r.forEach(e=>{if(e.id==="shiki-system")e.addEventListener("input",()=>{n.removeAttribute("data-theme"),sessionStorage.removeItem(o)});else{const t=e.getAttribute("value");t==s&&e.setAttribute("checked","true"),e.addEventListener("input",()=>{t&&typeof t=="string"&&(n.setAttribute("data-theme",t),sessionStorage.setItem(o,t))})}});</script> <!-- <header role="banner">
  
  <div class="logo">
    <h1>Documentazione Astro</h1>
  </div>

  
  <button aria-expanded="false" aria-controls="mainNav" id="toggleNav">
    ☰ Menu
  </button>

  
  <nav id="mainNav" role="navigation" hidden>
    <ul>
      <li><a href="#intro">Introduzione</a></li>
      <li><a href="#setup">Setup</a></li>
      <li><a href="#plugins">Plugin</a></li>
      <li><a href="#accessibility">Accessibilità</a></li>
    </ul>
  </nav>

  
  <aside role="complementary" aria-labelledby="settingsTitle">
    <h2 id="settingsTitle">Impostazioni</h2>
    <form aria-describedby="settingsDesc">
      <p id="settingsDesc">Seleziona le preferenze di visualizzazione:</p>

      
      <fieldset>
        <legend>Tema</legend>
        <label>
          <input type="radio" name="theme" value="light" aria-label="Tema chiaro">
          Chiaro
        </label>
        <label>
          <input type="radio" name="theme" value="dark" aria-label="Tema scuro">
          Scuro
        </label>
      </fieldset>

      
      <fieldset>
        <legend>Dimensione testo</legend>
        <label>
          <input type="radio" name="fontsize" value="small" aria-label="Testo piccolo">
          Piccolo
        </label>
        <label>
          <input type="radio" name="fontsize" value="medium" aria-label="Testo medio">
          Medio
        </label>
        <label>
          <input type="radio" name="fontsize" value="large" aria-label="Testo grande">
          Grande
        </label>
      </fieldset>
    </form>
  </aside>

 
 -->  <button type="button" id="to-top" aria-label="Porta in cima alla pagina" data-astro-cid-3ef6ksr2> <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" data-astro-cid-3ef6ksr2> <polygon points="12 4 20 20 4 20" fill="var(--font-color)" data-astro-cid-3ef6ksr2></polygon> </svg> </button> </header>  <script type="module">const t=document.getElementById("to-top");t?.addEventListener("click",()=>{scroll(0,0)});</script> <!-- <div id="background" aria-hidden="true"></div> --> <img src="/NotesRepo/Web_Dev/Astro/dist/_astro/teal.Cp8wgQFt_Z1ab9GP.webp" alt="background image" aria-hidden="true" id="background-big" loading="eager" decoding="sync" data-astro-cid-hpxbdaly="true" fetchpriority="auto" width="5120" height="2880"> <img src="/NotesRepo/Web_Dev/Astro/dist/_astro/hello.CW1iZbTK_Z1m486K.webp" alt="background image" aria-hidden="true" id="background-small" loading="eager" decoding="sync" data-astro-cid-hpxbdaly="true" fetchpriority="auto" width="1170" height="2532"> <main data-astro-cid-hpxbdaly> <header data-astro-cid-hpxbdaly> <h1 data-astro-cid-hpxbdaly>Asincronia in JavaScript</h1> <div id="breadcrumbs" data-astro-cid-hpxbdaly><nav id="local-nav" aria-label="Navigazione Argomento" data-astro-cid-sf7rw5md> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Classi/" title="pagina precedente" data-astro-cid-sf7rw5md> Classi </a> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Asincronia/" title="pagina corrente" data-astro-cid-sf7rw5md> Asincronia </a> <span aria-hidden="true" data-astro-cid-sf7rw5md></span> </nav> </div> </header> <div id="content" data-astro-cid-hpxbdaly> <nav aria-labelledby="page-index"> <h2 id="page-index">Indice</h2> <div id="index-list"><ul><li><a href="#esecuzione-sincrona">Esecuzione Sincrona</a><ul><li><a href="#esecuzione-asincrona">Esecuzione Asincrona</a></li></ul></li><li><a href="#callback">Callback</a></li><li><a href="#event-loop">Event Loop</a><ul><li><a href="#microtask-e-macrotask">Microtask e Macrotask</a></li><li><a href="#task-e-microtask-queue">Task e Microtask Queue</a></li></ul></li><li><a href="#promesse">Promesse</a></li></ul></div> </nav> <section><h2 id="esecuzione-sincrona">Esecuzione Sincrona</h2><p>Il codice JavaScript viene eseguito su un singolo <em>thread</em>, questo significa che JavaScript, normalmente, esegue le sue operazioni in modo sequenziale (esecuzione <strong>sincrona</strong>) e pertanto, perché una nuova operazione possa essere eseguita, quella precedente deve essere stata completata.</p><p>L’approccio sincrono funziona fin quando le operazioni possono essere completate in una quantità ristretta di tempo, ma operazioni tempo-intensive finiranno per congelare tutti gli script della pagina poichè solo una operazione può essere eseguita alla volta.</p><aside class="inserto esempio" aria-label="Esempio" data-heading="Esempio: "><p>Indica quanti numeri primi generare:
<input type="text" name="prime value ceil" id="quota" value="1000000">
<button type="button" id="generate">Genera numeri primi</button></p><p>Risultato: <span id="output"></span></p><p><mark class="flexible-marker flexible-marker-cyan flexible-marker-empty"></mark></p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> MAX_PRIME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> 1000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">x</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">&#x3C;=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">sqrt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(x); i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">        // verifichiamo che x non sia divisibile per i</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">===</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;} </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> (</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">    // genera intero tra 0 e max</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">floor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(Math.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">random</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">max);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> generatePrimes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">howMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">maxPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> primes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> [];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(primes.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> &#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> howMany) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> candidate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> random</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(maxPrime);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(candidate)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            primes.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(candidate);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> primes;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> primer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">quota</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> primesHere</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">output</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> triggerPrime</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> lock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">triggerPrime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">click</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(lock) {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        lock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        primesHere.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284"> '</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Generazione in corso...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">                const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> primes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> generatePrimes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(primer.value, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">MAX_PRIME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                primesHere.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C"> `Generati </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#FF79C6">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">primes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F8F8F2">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">length</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#FF79C6">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C"> numeri primi casuali`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">finally</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> { lock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">; }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">})</span></span></code></pre><p>Possiamo osservare come la generazione di numeri primi impieghi tempo (se non succede, chiedi di generare più numeri), inoltre, la pagina diventa irresponsiva nel mentre la funzione <code>generatePrimes</code> è in esecuzione.</p><p>Un modo semplice per verificarlo è avviare la generazione e cercare di interagire con i controlli.</p><script>
const MAX_PRIME = 1000000;

function isPrime(x) {
    for(let i = 2; i <= Math.sqrt(x); i++) {
        // verifichiamo che x non sia divisibile per i
        if(x % i === 0) {return false;} 
    }
    return x > 1;
}

const random = (max) => {
    // genera intero tra 0 e max
    return Math.floor(Math.random()*max);
}

function generatePrimes(howMany, maxPrime) {
    const primes = [];
    while(primes.length < howMany) {
        const candidate = random(maxPrime);
        if(isPrime(candidate)) {
            primes.push(candidate);
        }
    }
    return primes;
}

const primer = document.getElementById('quota');
const primesHere = document.getElementById('output');
const triggerPrime = document.getElementById('generate');

let lock = false;
triggerPrime.addEventListener('click', () => {
    if(lock) {return;}
    triggerPrime.setAttribute('disabled', 'true');
    try {
        lock = true;
        primesHere.textContent = 'Generazione in corso...';
        setTimeout(
            () => {
                const primes = generatePrimes(primer.value, MAX_PRIME);
                primesHere.textContent = `Generati ${primes.length} numeri primi casuali`;
            }, 0
        )
        
    } finally { 
        lock = false; 
        triggerPrime1.removeAttribute('disabled');
    }
})
</script></aside><section><h3 id="esecuzione-asincrona">Esecuzione Asincrona</h3><p>La programmazione <strong>asincrona</strong> permette a JavaScript di seguire l’esecuzione di operazioni secondarie mentre procede con l’esecuzione del thread principale.</p></section></section>
<section><h2 id="callback">Callback</h2><p>Una prima soluzione è quella di dividere l’operazione pesante in una serie di funzioni di callback annidate, tuttavia questo genera un codice estremamente difficile da leggere e mantenere.</p><aside class="inserto esempio" aria-label="Esempio" data-heading="Esempio: "><p>Consideriamo, per iniziare, tre funzioni che chiamano la console e diamogli un timer per simulare il tempo di esecuzione:</p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Prima operazione</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">    2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> );</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Seconda operazione</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">    1600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> );</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Terza operazione</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">    1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> );</span></span></code></pre><p><button type="button" id="call1">Avvia:</button></p><p id="call1T" style="white-space: pre;"></p><script>
const call1 = document.getElementById('call1');
const call1Targ = document.getElementById('call1T');

lock1 = false;
call1.addEventListener('click', () => {
    if(lock1) {
        console.log("Attendi il completamento dell'operazione in corso");
        return;
    }
    lock1 = true;
    call1Targ.textContent = '';
    setTimeout(() => {
        call1Targ.textContent += 'Prima operazione\n';
        lock1 = false; 
    }, 2000 );
    setTimeout(() =>
        call1Targ.textContent += 'Seconda operazione\r\n',
        1600 );
    setTimeout(() => 
        call1Targ.textContent +='Terza operazione\r\n',
        1200 );
})
</script><p>Le operazioni vengono iniziate sequenzialmente, ma questo riguarda solo la partenza dei timer, infatti in output le troviamo in ordine da quella più breve a quella più lunga;</p><p>per poter dare un ordine indipendente dal tempo di esecuzione, potrebbe non bastare chiamare le funzioni in ordine, un modo migliore è di passare la funzione che vogliamo eseguire dopo come argomento a quella in esecuzione, cioè usare una <em>funzione di callback</em>:</p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> task1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> (</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Prima operazione</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">    2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> task2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> (</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Seconda operazione</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">    1600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> task3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> (</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Terza operazione</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">    1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span></code></pre><p>Chiamiamole nella sequenza desiderata:</p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">task1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    task2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        task3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">            null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">});</span></span></code></pre><p><button type="button" id="call2">Avvia:</button></p><p id="call2T" style="white-space: pre;"></p><script>
const call2 = document.getElementById('call2');
const call2Targ = document.getElementById('call2T');

lock2 = false;
call2.addEventListener('click', () => {
    if(lock1) {
        console.log("Attendi il completamento dell'operazione in corso");
        return;
    }
    lock2 = true;
    call2Targ.textContent = '';
    setTimeout(() => {
        call2Targ.textContent += 'Prima operazione\n';
        setTimeout(() => {
            call2Targ.textContent += 'Seconda operazione\r\n';
            setTimeout(() => {
                call2Targ.textContent +='Terza operazione\r\n';
                lock2 = false; 
            }, 1200 );
        }, 1600 );     
    }, 2000 );  
});
</script><p>Questo sarebbe il risultato del suddividere una grossa operazione in sotto operazioni da eseguire ordinatamente, tuttavia, questo metodo diventa ingestibile molto presto, infatti, se avessimo necessità di dividere un’operazione in 9 step:</p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">step1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    step2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        step3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">            step4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">                step5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">                    step6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">                        step7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">                            step8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">                                step9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">                                    null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                                )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">});</span></span></code></pre><p>Ci ritroveremmo con una piramide di callback detta <em>callback hell</em>.</p></aside><aside class="inserto osservazione" aria-label="Osservazione" data-heading="Osservazione: "><p>Riprendendo l’esempio dei numeri primi, possiamo suddividere in step la generazione di numeri primi:</p><p><mark class="flexible-marker flexible-marker-cyan flexible-marker-empty"></mark></p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> generatePrimesSequence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">nowMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">howMany</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">maxPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">currentStep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-dracula:#FFB86C;--shiki-dracula-font-style:italic">step</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> STEP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> step;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(array.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> >=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> maxPrime) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        currentStep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        lock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(array.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> &#x3C;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> (nowMany </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> STEP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">)) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> candidate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B"> random</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(maxPrime);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">isPrime</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(candidate)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            array.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(candidate);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        currentStep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(nowMany </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> array.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">        generatePrimesSequence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(array, nowMany, howMany, maxPrime, currentStep, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">STEP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">triggerPrime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">click</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(lock) {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    lock </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    primesHere.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284"> '</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Generazione in corso...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">            const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2"> primes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> [];</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">            generatePrimesSequence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(primes, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, primer1.value, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">MAX_PRIME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">                primesHere.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C"> `Generati </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#FF79C6">${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">primes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F8F8F2">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#F8F8F2">length</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#FF79C6">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C"> numeri primi casuali`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">            }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">        }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">});</span></span></code></pre><p>Indica quanti numeri primi generare:
<input type="text" name="prime value ceil" id="quota1" value="1000000">
<button type="button" id="generate1">Genera numeri primi</button></p><p>Risultato: <span id="output1"></span></p><p>In questo esempio, abbiamo scaglionato la generazione di numeri primi in modo da crearne 1000 alla volta; ogni 1000 numeri primi creati, viene chiamata ricorsivamente la funzione generatrice per crearne altri 1000 fino al raggiungimento dell’obiettivo.</p><p>Osserviamo che in realtà JavaScript sta’ comunque eseguendo 1 operazione alla volta, tuttavia la generazione di 1000 numeri primi è sufficientemente piccola da poterna alternare all’esecuzione del thread principale,</p><p>infatti, se aumentiamo lo step a 10000:</p><p>Indica quanti numeri primi generare:
<input type="text" name="prime value ceil" id="quota2" value="1000000">
<button type="button" id="generate2">Genera numeri primi</button></p><p>Risultato: <span id="output2"></span></p><p>Osserviamo che la pagina non rimane congelata, ma va’ invece a scatti.</p><aside class="inserto notabene" aria-label="Nota importante" data-heading="Nota Bene: "><p>È strettamente necessario usare <code>setTimeout</code> in questa situazione (ricorsione) per permettere al browser di tornare al thread principale alla fine della generazione dei numeri primi ad ogni step</p><script>

function generatePrimesSequence(array, nowMany, howMany, maxPrime, currentStep, step) {
    const STEP = step;
    if(array.length >= maxPrime) {
        currentStep();
        lock = false;
        triggerPrime1.removeAttribute('disabled');
        triggerPrime2.removeAttribute('disabled');
        return;
    }
    while(array.length < (nowMany + STEP)) {
        const candidate = random(maxPrime);
        if(isPrime(candidate)) {
            array.push(candidate);
        }
    }
    setTimeout(() => {
        currentStep();
        console.log(nowMany = array.length);
        generatePrimesSequence(array, nowMany, howMany, maxPrime, currentStep, STEP);
    }, 0);
}


const primer1 = document.getElementById('quota1');
const primesHere1 = document.getElementById('output1');
const triggerPrime1 = document.getElementById('generate1');


triggerPrime1.addEventListener('click', () => {
    if(lock) {return;}
    lock = true;
    triggerPrime1.setAttribute('disabled', 'true');
    primesHere1.textContent = 'Generazione in corso...';
    setTimeout(
        () => {
            const primes = [];
            generatePrimesSequence(primes, 0, primer1.value, MAX_PRIME, 
            () => {
                primesHere1.textContent = `Generati ${primes.length} numeri primi casuali`;
            }, 1000);
        }, 0
    )
});

const primer2 = document.getElementById('quota2');
const primesHere2 = document.getElementById('output2');
const triggerPrime2 = document.getElementById('generate2');


triggerPrime2.addEventListener('click', () => {
    if(lock) {return;}
    lock = true;
    triggerPrime2.setAttribute('disabled', 'true');
    primesHere2.textContent = 'Generazione in corso...';
    setTimeout(
        () => {
            const primes = [];
            generatePrimesSequence(primes, 0, primer2.value, MAX_PRIME, 
            () => {
                primesHere2.textContent = `Generati ${primes.length} numeri primi casuali`;
            }, 10000);
        }, 0
    )
});
</script></aside></aside></section>
<section><h2 id="event-loop">Event Loop</h2><section><h3 id="microtask-e-macrotask">Microtask e Macrotask</h3><p>JavaScript resta single-threaded, cioè può eseguire solo una operazione alla volta, tuttavia, le operazioni sincrone non sono l’unico tipo di operazioni che JavaScript può gestire; due tipi di operazioni asincrone possono essere gestite da JavaScript:</p><ul>
<li><em>Microtask</em>: operazioni asincrone ad alta priorità, come le callback delle <code>Promise</code></li>
<li><em>Macrotask</em>: operazioni asincrone a bassa priorità, come quelle in callback a <code>setTimeout</code>, <code>setInterval</code> o gli eventi del DOM (<code>addEventListener</code>)</li>
</ul><p><em>Le operazioni sincrone vengono eseguite immediatamente da JavaScript, mentre i microtask e i macrotask vengono eseguiti solo quando JavaScript è “libero”</em>.</p></section><section><h3 id="task-e-microtask-queue">Task e Microtask Queue</h3><p>Le funzioni <code>setTimeout</code>, <code>setInterval</code>, <code>addEventListener</code> e simili sono tutte <mark class="flexible-marker flexible-marker-umber">funzioni sincrone</mark> che vengono eseguite subito, non appena raggiunte dall’interprete del browser;</p><p>quelle asincrone sono le loro funzioni di callback:</p><ol>
<li>la <mark class="flexible-marker flexible-marker-umber"><em>funzione sincrona</em></mark> (tipo <code>setTimeout</code>) viene eseguita <em>immediatamente</em></li>
<li>la <mark class="flexible-marker flexible-marker-umber"><em>funzione di callback</em></mark> interna è un microtask/macrotask e viene <em>registrata per essere eseguita seccessivamente</em> (in una lista di operazioni a bassa priorità)</li>
<li>la funzione sincrona ha completato la sua esecuzione e quindi il <em>compilatore può proseguire con il thread principale</em></li>
<li>quando il compilatore non ha operazioni principali da eseguire, ne <em>esegue una dalla lista a bassa priorità</em></li>
</ol><aside class="inserto esempio" aria-label="Esempio" data-heading="Esempio: "><p>Osserviamo l’ordine di esecuzione di una sequenza di operazioni sincrone, intermezzate da alcune asincrone:</p><pre class="astro-code astro-code-themes github-light github-dark dracula" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-dracula:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;--shiki-dracula-bg:#282A36; overflow-x: auto;" tabindex="0" data-language="js"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Partenza (sync)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// sync</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Continuo (sync)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// sync</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> { </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">    // registra macrotask 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Asincrono-1 (macro)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">)}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Ancora (sync)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// sync</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-dracula:#8BE9FD;--shiki-dracula-font-style:italic">Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> { </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">    // registra microtask</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">"</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Asincrono-2 (micro)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">)});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">e ancora (sync)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// sync</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;--shiki-dracula:#FF79C6">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2"> { </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">    // registra macrotask 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Asincrono-3 (macro)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">)}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;--shiki-dracula:#BD93F9">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;--shiki-dracula:#50FA7B">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#F1FA8C">Fine (sync)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;--shiki-dracula:#E9F284">'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;--shiki-dracula:#F8F8F2">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// sync</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// esegue microtask</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// esegue macrotask 1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;--shiki-dracula:#6272A4">// esegue macrotask 2</span></span></code></pre><p><button type="button" id="eg1">Avvia</button></p><p>Risultato: <span id="outscoop" style="white-space: pre;"></span></p><script>
const classOut = document.getElementById('outscoop');
document.getElementById('eg1').addEventListener('click', () => {
    classOut.textContent = '\r\nPartenza (sync)\r\n';
    classOut.textContent += 'Continuo (sync)\r\n';
    setTimeout(() => {
        classOut.textContent += 'Asincrono-1 (macro)\r\n';
    }, 0);
    classOut.textContent += 'Ancora (sync)\r\n';
    Promise.resolve().then(() => {
        classOut.textContent += 'Asincrono-2 (micro)\r\n';
        })
    classOut.textContent += 'e ancora (sync)\r\n';
    setTimeout(() => {
        classOut.textContent += 'Asincrono-3 (macro)\r\n';
    }, 0);
    classOut.textContent += 'Fine (sync)\r\n';
})
</script><p>Osserviamo che <em>le operazioni asincrone vengono eseguite per ultime</em>, anche se il timer impostato per il delay della loro esecuzione è <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">0ms</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span></span></span></span>, questo perché le callback di <code>setTimeout</code> e <code>Promise</code> sono eseguite in modo asincrono, non sincrono; hanno priorità inferiore alle altre operazioni sincrone, quindi, in una ipotetica coda di esecuzione delle operazioni, quelle asincrone vengono messe alla fine, dopo quelle sincrone.</p><p>Questo meccanismo permette al compilatore di concentrarsi sulle operazioni sincrone (del thread principale) senza quindi bloccare l’esecuzione dello script per operazioni più pesanti, che andrebbero eseguite in modo asincrono</p></aside><p>L’<em>event loop</em> gestisce l’ordine delle operazioni eseguite scegliendole tra tre liste ordinate:</p><ul>
<li><strong>Call Stack</strong>: la lista delle chiamate tiene traccia delle chiamate di funzione nel codice e, ogni volta che una avviene, l’esecuzione della funzione chiamata viene messa in coda alla lista; JavaScript esegue sempre l’<em>ultima</em> operazione della lista, quindi la <em>call stack</em> segue un principio LIFO (<em>Last-In-First-Out</em>), cioè l’ultima ad essere inserita nella lista è la prima ad essere eseguita</li>
<li><strong>Task Queue</strong>: la lista dei macrotask comprende delle callback generate dal completamento di funzioni quali <code>setTimeout</code>, <code>setInterval</code>, <code>fetch</code> o eventi del DOM</li>
<li><strong>Microtask Queue</strong>: la lista dei microtask comprende principalmente le callback delle <code>Promise</code></li>
</ul><p>L’<strong>Event Loop</strong> (<em>ciclo degli eventi</em>): tiene traccia delle tre liste; se la call stack è vuota, passa una operazione dalla microtask queue alla call stack, se anche la microtask queue è vuota, allora prende l’operazione dalla task queue.</p></section></section>
<section><h2 id="promesse">Promesse</h2><p>L’approccio moderno all’<strong>asincronia</strong> prevede l’utilizzo di un proxy per gestire l’operazione:</p><ol>
<li>Le operazioni pesanti sono incapsulate in speciali funzioni asincrone,</li>
<li>Immediatamente dopo la chiamata, la funzione asincrona restituisce un proxy dello stato dell’operazione,</li>
<li>L’esecuzione dello script prosegue normalmente e intanto un “ascoltatore” (simile agli eventi) resta in attesa che il proxy produca una risposta da passare a una callback che la processerà</li>
</ol><p>Il proxy che viene generato dalla funzione asincrona è un oggetto <strong><code>Promise</code></strong> che contiene due proprietà speciali: uno stato e un risultato.</p><p>La proprietà stato (<code>state</code>) può essere uno di tre valori</p></section> </div> </main> <footer class="test-footer" data-astro-cid-jyhwcbfj> <nav id="local-nav" aria-label="Navigazione Argomento" data-astro-cid-sf7rw5md> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Classi/" title="pagina precedente" data-astro-cid-sf7rw5md> Classi </a> <a href="/NotesRepo/Web_Dev/Astro/dist/javascript/Asincronia/" title="pagina corrente" data-astro-cid-sf7rw5md> Asincronia </a> <span aria-hidden="true" data-astro-cid-sf7rw5md></span> </nav>  <p data-astro-cid-jyhwcbfj>Pagina iniziale del sito a <a href="/NotesRepo/Web_Dev/Astro/dist/../../html/Sintassi html/" data-astro-cid-jyhwcbfj>questo indirizzo</a></p> <p data-astro-cid-gcm7ptol>Puoi trovarmi anche su
<a href="https://www.github.com/italocorraro" data-astro-cid-gcm7ptol>github</a></p> </footer> <script type="module">const c=document.querySelectorAll("p:has(> .flexible-marker-cyan)");c.forEach(function(e){e.querySelector(".flexible-marker-cyan").addEventListener("click",()=>{e.classList.toggle("code-show-next")})});</script> </body> </html> 